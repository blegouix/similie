<!--
SPDX-FileCopyrightText: 2024 Baptiste Legouix
SPDX-License-Identifier: GPL-3.0-or-later
-->
<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SimiLie: Tensor module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeParagraphLink.init()
</script>
</head>
<body>
<a href="https://github.com/blegouix/similie" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
  <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
  <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="index.html"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign">
   <div id="projectname">SimiLie
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('tensor_module.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Tensor module</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_tensor__module"></a></p>
<h1><a class="anchor" id="autotoc_md6"></a>
Why tensors are importants for physics ?</h1>
<p><a href="https://en.wikipedia.org/wiki/Tensor">Tensors</a> are the numerical counterparts of algebraic structures which form the base of fundamental physics as Lie algebra (represent gauge fields) or Clifford algebra (represent fermionic fields). They can thus constitute the building blocks of quantum physics solvers (long term roadmap of SimiLie).</p>
<p>They also appear in classical physics, with ie. the <a href="https://en.wikipedia.org/wiki/Cauchy_stress_tensor">Cauchy stress tensor</a> which describes internal forces in a fluid or solid or the <a href="https://en.wikipedia.org/wiki/Maxwell_stress_tensor">Maxwell stress tensor</a> if those forces are due to the interaction of the medium with the electromagnetic field. The <a href="https://en.wikipedia.org/wiki/Metric_tensor">Metric tensor</a> is of particular importance because it allows to evaluate distances on a manifold (like space-time in general relativity or more simply non-cartesian coordinate system).</p>
<p>In general relativity, the <a href="https://en.wikipedia.org/wiki/Christoffel_symbols">Christoffel symbols</a> are not technically tensors (because they do not transform as such under diffeomorphism) but are at least multidimensional arrays which allow to compute geodesics. The <a href="https://en.wikipedia.org/wiki/Riemann_curvature_tensor">Riemann tensor</a> and the <a href="https://en.wikipedia.org/wiki/Stress%E2%80%93energy_tensor">Stress-energy tensor</a> are also at the heart of the theory, as they respectively describe the curvature of space-time and its content in stress, momentum and energy (while being <a href="https://en.wikipedia.org/wiki/Covariant_transformation">invariant under change of basis</a>).</p>
<p>A special class of tensors are the <a href="https://en.wikipedia.org/wiki/Antisymmetric_tensor">antisymmetric tensors</a> which correspond to differential forms (ie. the <a href="https://en.wikipedia.org/wiki/Electromagnetic_tensor">Faraday tensor</a> of electromagnetism), implemented in the <a class="el" href="exterior_module.html">Exterior module</a> of SimiLie. Even more specials are the <a href="https://en.wikipedia.org/wiki/Vector_(mathematics_and_physics)">vectors</a> which correspond to 1-forms.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Scalar">Scalar</a> corresponds to a 0-form and is a degenerated (rank-0) type of tensors.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Do Kokkos and DDC support tensor fields ? What can SimiLie do in addition ?</h1>
<p>Kokkos aims to handle <a href="https://en.wikipedia.org/wiki/Array_\(data_structure\)#Multidimensional_arrays">Multidimensional arrays</a>. A rank-N tensor field defined over a M-dimension discrete manifold can be stored as a N*M-dimensions array. But this is not very convenient, because Kokkos does not allow to labelize the dimensions of the array, so the user has to keep track of the ordering of physical dimensions and tensor indices, which may be very cumbersome and can easily lead to silent bugs.</p>
<p>DDC offers the possibility to labelize the physical dimensions, but its support for tensor fields is limited. Scalar fields are described using the <code>ddc::Chunk</code> and <code>ddc::ChunkSpan</code> classes, which internally relie on <code>mdspan</code> (the C++ standardization of <code>Kokkos::View</code>). They take as a template argument a <code>ddc::DiscreteDomain</code>, which is itself template by the physical dimensions of the problem:</p>
<div class="fragment"><div class="line">ddc::DiscreteDomain&lt;DDimX, DDimY, DDimZ&gt;</div>
</div><!-- fragment --><p>A simple way to support a tensor field would be adding non-physical dimensions representing tensor indices, ie.:</p>
<div class="fragment"><div class="line">ddc::DiscreteDomain&lt;DDimX, DDimY, DDimZ, Mu, Nu&gt;</div>
</div><!-- fragment --><p>This is precisely the starting point of SimiLie, which extents this natural support of tensor fields in DDC to tensor fields with internal symmetries (diagonal tensor, symmetric tensor, antisymmetric tensor, etc... or tensor product of lower-rank tensors with their own internal symmetries). Under the hood there are still <code>ddc::Chunk</code> and <code>mdspan</code> but convenient interfaces are provided to manipulate tensors with internal symmetries.</p>
<dl class="section important"><dt>Important</dt><dd>The <code>Tensor</code> terminology in SimiLie does not guarantee the invariance under diffeomorphism, as it is the case in maths and physics. Tensor fields in SimiLie are just multidimensional arrays mapped over discrete manifolds and with convenient accessors to benefit from internal symmetries.</dd></dl>
<h1><a class="anchor" id="autotoc_md8"></a>
Tensor indices</h1>
<p>First, the class <code>TensorNaturalIndex</code> allows to build natural indices like <code>Mu</code> or <code>Nu</code> while giving the different labels it can take (ie. <code>T</code>, <code>X</code>, <code>Y</code> and <code>Z</code>). When the following DDC code declares a new dimension:</p>
<div class="fragment"><div class="line">struct X;</div>
<div class="line">struct DDimX : ddc::UniformPointSampling&lt;X&gt; {};</div>
</div><!-- fragment --><p>The following SimiLie code declares a new natural index:</p>
<div class="fragment"><div class="line">struct T;</div>
<div class="line">struct X;</div>
<div class="line">struct Y;</div>
<div class="line">struct Z;</div>
<div class="line">struct Mu : sil::tensor::TensorNaturalIndex&lt;T, X, Y, Z&gt; {};</div>
</div><!-- fragment --><p>But several indices like <code>Mu, Nu</code> in the template arguments of a <code>ddc::DiscreteDomain</code> do not have any particular symmetry (that's why they are so-said <em>natural</em>). A <code>TensorNaturalIndex</code> is necessarily rank-1. Then, several classes sharing the same API are provided to describe a tensor index (which may be of any rank, which means it may correspond to any arbitrary number of natural indices):</p>
<ul>
<li><code>TensorIdentityIndex</code>: identity tensor index, <code>1</code> on the diagonal, <code>0</code> out of it. No runtime allocation required.</li>
<li><code>TensorLorentzianSignIndex</code>: Lorentzian signature tensor index, diagonal with <code>p</code> <code>-1</code> and <code>q</code> <code>1</code>, ie. the Lorentz metric of special relativity. No runtime allocation required.</li>
<li><code>TensorLeviCivitaIndex</code>: <a href="https://en.wikipedia.org/wiki/Levi-Civita_symbol">Levi-Civita tensor</a> index. Must be squared and have a number of elements in a dimension equal to its rank. No runtime allocation required.</li>
<li><code>TensorDiagonalIndex</code>: Diagonal tensor index. Only diagonal is stored at runtime.</li>
<li><code>TensorSymmetricIndex</code>: Symmetric tensor index. Only upper-left triangle (or higher-rank equivalent) is stored at runtime.</li>
<li><code>TensorAntisymmetricIndex</code>: Skew-symmetric tensor index. Only upper-left triangle excluding diagonal (or higher-rank equivalent) is stored at runtime.</li>
<li><code>TensorFullIndex</code>: Full tensor product index. Every elements are stored at runtime.</li>
<li><code>TensorYoungTableauIndex</code>: This one is very special and not yet documented. Ie. the Riemann tensor.</li>
</ul>
<p>All those classes are templated by any number of <code>TensorNaturalIndex</code>. Keep in mind that dimensions, natural indices and non-natural indices can coexist in any order in the template arguments of a <code>ddc::DiscreteDomain</code> type. Ie.:</p>
<div class="fragment"><div class="line">struct DDimX : ddc::UniformPointSampling&lt;X&gt; {};</div>
<div class="line">struct DDimY : ddc::UniformPointSampling&lt;Y&gt; {};</div>
<div class="line">struct Mu : sil::tensor::TensorNaturalIndex&lt;X, Y&gt; {};</div>
<div class="line">struct Nu : sil::tensor::TensorNaturalIndex&lt;X, Y&gt; {};</div>
<div class="line">struct Rho : sil::tensor::TensorNaturalIndex&lt;X, Y&gt; {};</div>
<div class="line">using DDom = ddc::DiscreteDomain&lt;DDimX, Rho, DDimY, sil::tensor::TensorSymmetricIndex&lt;Mu, Nu&gt;&gt;;</div>
</div><!-- fragment --><p>is perfectly valid and <code>DDom</code> represents the type of the support of a rank-3 tensor field on a <code>XY</code> manifold, with the pair <code>Mu, Nu</code> being symmetric.</p>
<dl class="section attention"><dt>Attention</dt><dd>The contiguity-coalescence rule of DDC still stands in SimiLie: the leftest template argument of the <code>ddc::DiscreteDomain</code> declaration will be the most coalescent in the underlying multidimensional array while the rightest will be the most contiguous.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><code>ddc::DiscreteDomain&lt;Mu, Nu&gt;</code> and <code>ddc::DiscreteDomain&lt;<a class="el" href="structsil_1_1tensor_1_1TensorFullIndex.html">sil::tensor::TensorFullIndex</a>&lt;Mu, Nu&gt;&gt;</code> are mostly the same thing.</dd></dl>
<dl class="section important"><dt>Important</dt><dd>Nested non-natural tensor indices are forbidden, ie. <code><a class="el" href="structsil_1_1tensor_1_1TensorSymmetricIndex.html">sil::tensor::TensorSymmetricIndex</a>&lt;<a class="el" href="structsil_1_1tensor_1_1TensorAntisymmetricIndex.html">sil::tensor::TensorAntisymmetricIndex</a>&lt;Mu, Nu&gt;, Rho&gt;</code> is not valid.</dd></dl>
<h1><a class="anchor" id="autotoc_md9"></a>
Internal mechanism</h1>
<p>The most important concept to understand is that elements of tensors are indexed (in the sense of <em>associated to integers which identify their positions</em>) using three different kind of <code>id</code>s:</p>
<ul>
<li>The <code>natural_ids</code> is the most intuitive, ie. <code>(1, 2)</code> identifies the tensor element at index <code>1</code> along the rows and at index <code>2</code> along the columns, regardless of the eventual symmetries of the tensor.</li>
<li>The <code>access_id</code> gives a way to benefit from internal symmetries when trying to access to an element of a tensor. Ie. all the non-diagonal elements of a diagonal tensor share the same value <code>0</code> and are thus accessed using the same <code>access_id</code> (which is also <code>0</code>) while diagonal terms are accessed starting from <code>1</code>.</li>
<li>The <code>mem_id</code> corresponds to the location in the memory, ie. the non-diagonal elements of a diagonal tensor are known to be <code>0</code> so they do not need to be stored, thus only the diagonal is stored starting from <code>0</code>.</li>
</ul>
<p>Most of the logic implemented in the <code><a class="el" href="tensor__impl_8hpp_source.html">tensor_impl.hpp</a></code> file aims to provide kind-of-converters between those three kinds of <code>id</code>s.</p>
<h1><a class="anchor" id="autotoc_md10"></a>
Tensor accessor</h1>
<p>Once the different tensor indices involved in your physical problem are declared, you need to declare a <code>TensorAccessor</code> templated by those indices. Ie.:</p>
<div class="fragment"><div class="line">struct Mu : sil::tensor::TensorNaturalIndex&lt;X, Y, Z&gt; {};</div>
<div class="line">struct Nu : sil::tensor::TensorNaturalIndex&lt;X, Y, Z&gt; {};</div>
<div class="line">struct Rho : sil::tensor::TensorNaturalIndex&lt;X, Y, Z&gt; {};</div>
<div class="line">using Sigma = sil::tensor::TensorAntisymmetricIndex&lt;Mu, Nu&gt;;</div>
<div class="line">[[maybe_unused]] sil::tensor::TensorAccessor&lt;Rho, Sigma&gt; tensor_accessor;</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The <code>[[maybe_unused]]</code> is convenient because all the member functions of <code>TensorAccessor</code> are <code>static</code>, so it avoids a compilation warning.</dd></dl>
<dl class="section important"><dt>Important</dt><dd>The <code>TensorAccessor</code> class only handles the indicial part of a tensor (ie. not the dimensions of the manifold supporting a tensor field). You must not pass dimensions to its template arguments!</dd></dl>
<p>Then using the accessor you can get the required domain supporting the allocation of such a tensor with:</p>
<div class="fragment"><div class="line">ddc::DiscreteDomain&lt;Rho, Sigma&gt; single_tensor_dom = tensor_accessor.mem_domain();</div>
</div><!-- fragment --><p>But in practice it is more convenient to directly compute the cartesian product with the mesh:</p>
<div class="fragment"><div class="line">ddc::DiscreteDomain&lt;DDimX, DDimY&gt; mesh_xy(ddc::DiscreteElement(0, 0), ddc::DiscreteVector(1000, 1000));</div>
<div class="line">ddc::DiscreteDomain&lt;DDimX, DDimY, Rho, Sigma&gt; tensor_field_dom(mesh_xy, tensor_accessor.mem_domain());</div>
</div><!-- fragment --><p>The <code>mem_domain()</code> functions produces the domain in which the <code>mem_id</code>s stand. Ie. for an identity tensor, <code>mem_domain()</code> will produce a domain of size <code>0</code>.</p>
<dl class="section note"><dt>Note</dt><dd><code>TensorAccessor</code> also provides several member functions to perform kind-of-conversions between the three kinds of indices. Please check its API, examples and tests for common usage.</dd></dl>
<h1><a class="anchor" id="autotoc_md11"></a>
Tensor class</h1>
<p>In DDC an allocation is made using the <code>ddc::Chunk</code> class. We do the same in SimiLie (ie. on CPU) :</p>
<div class="fragment"><div class="line">ddc::Chunk tensor_field_alloc(tensor_field_dom, ddc::HostAllocator&lt;double&gt;());</div>
</div><!-- fragment --><p>In DDC we would then build a <code>ddc::ChunkSpan</code> to manipulate this data. In SimiLie we have a class <code>Tensor</code> which derives from <code>ChunkSpan</code> and which is more convenient to represent tensor fields:</p>
<div class="fragment"><div class="line">sil::tensor::Tensor tensor_field(tensor_field_alloc);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><code>Tensor</code> provides a lot of member functions to perform usefull operations like accessing an element or slicing using natural indices, etc.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Remember that <code>TensorAccessor</code> only handles the indicial part of the tensor, while <code>Tensor</code> handles the whole field involving indicial and non-indicial parts of its support. Please check their respective APIs, the tests and examples for common usages.</dd></dl>
<h1><a class="anchor" id="autotoc_md12"></a>
Metric</h1>
<p>A metric is a squared symmetric rank-2 tensor field \(g\) with number of elements along one of the tensor dimensions equal to the dimension of the manifold. It encodes the local information required to compute a distance \(s\) on a Riemannian manifold:</p>
<p class="formulaDsp">
\[
ds^2 = g_{\mu\nu}\;dx^\mu\; dx^\nu
\]
</p>
<p>The simplest metric is the Euclidean metric which is the identity tensor. A Lorentzian metric is the equivalent in special relativistic frame. More complicated metrics are used in general relativity or non-cartesian coordinate systems.</p>
<p>In SimiLie a metric is defined using the two natural tensor indices <code>MetricIndex1</code> and <code>MetricIndex2</code>. A metric index is defined as ie.:</p>
<div class="fragment"><div class="line">using MetricIndex = sil::tensor::TensorSymmetricIndex&lt;sil::tensor::MetricIndex1&lt;X, Y, Z&gt;, sil::tensor::MetricIndex2&lt;X, Y, Z&gt;&gt;;</div>
</div><!-- fragment --><p>And the metric tensor field is build upon it as described previously.</p>
<p>The most usefull usage of metric is <em>lowering</em> or <em>raising</em> indices. Indeed, on Riemannian manifolds the natural indices are attributed with a <em>covariant</em> or <em>contravariant character</em>. It is very convenient to produce a tensor product of metrics (like \(g_{\mu\mu&#39;}\;g_{\nu\nu&#39;}\;g_{\rho\rho&#39;}\)), which is permitted by the <code>fill_metric_prod</code> function.</p>
<p>Lowering indices is thus made by performing a tensor product with a contravariant tensor, ie.:</p>
<p class="formulaDsp">
\[
T_{\mu\nu\rho} = g_{\mu\mu&#39;}\;g_{\nu\nu&#39;}\;g_{\rho\rho&#39;}\;T^{\mu&#39;\nu&#39;\rho&#39;}
\]
</p>
<p>using the <code>tensor_prod</code> function described in next section, or the <code>inplace_apply_metric</code> function if you want to reuse the allocation of \(T^{\mu&#39;\nu&#39;\rho&#39;}\) to store \(T_{\mu\nu\rho}\) (which internally relies on <code>tensor_prod</code>).</p>
<dl class="section note"><dt>Note</dt><dd>The <code>fill_inverse_metric</code> function relies on <code>kokkos-kernels</code> <code>KokkosBatched::SerialInverseLU</code> function to compute the inverse metric (contravariant indexing of the metric, used to raise indices afterward).</dd></dl>
<h1><a class="anchor" id="autotoc_md13"></a>
Tensor product</h1>
<p>The generic <code>tensor_prod</code> function supports input and output tensors with any kind of internal symmetries. The Einstein convention stands: indices appearing in the two input tensors (one covariant and the other contravariant) are contracted while other indices are spectators (outer product). Any memory layouts are supported but bad choice of layout may highly deteriorate the performance.</p>
<dl class="section important"><dt>Important</dt><dd><code>tensor_prod</code> does not support tensor fields. You need to iterate over the nodes of the mesh, extract tensors (using the <code>Tensor::operator[]</code> function) and call <code>tensor_prod</code> at each node. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!--
SPDX-FileCopyrightText: 2024 Baptiste Legouix
SPDX-License-Identifier: GPL-3.0-or-later
-->
<!-- HTML footer for doxygen 1.9.8-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
